# PRD: Pydantic AI Agent Platform on VertexAI Agent Engine

**문서 버전**: 1.0  
**작성일**: 2026-02-02  
**작성자**: Platform Team  
**상태**: Draft  

---

## 1. 개요 (Executive Summary)

### 1.1 프로젝트 목적

VertexAI Agent Engine을 활용하여 Pydantic AI 기반의 Production-ready AI Agent 플랫폼을 구축한다. 이 플랫폼은 대화형 AI 에이전트의 개발, 배포, 운영을 위한 표준화된 인프라를 제공하며, Session 관리와 장기 메모리(Memory Bank)를 통해 개인화된 사용자 경험을 제공한다.

### 1.2 비즈니스 목표

| 목표 | 측정 지표 | 목표치 |
|------|----------|--------|
| 개발 생산성 향상 | 에이전트 배포 소요 시간 | < 30분 |
| 운영 안정성 확보 | 서비스 가용성 (SLA) | 99.9% |
| 사용자 경험 개선 | 대화 컨텍스트 유지율 | > 95% |
| 비용 효율화 | 인프라 관리 인력 | 0명 (관리형) |

### 1.3 핵심 가치 제안

```
┌─────────────────────────────────────────────────────────────────────────┐
│                         Value Proposition                                │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   👨‍💻 개발자           🏢 비즈니스           👤 최종 사용자              │
│   ──────────         ──────────           ──────────────              │
│   • 빠른 배포         • 낮은 운영 비용      • 개인화된 응답              │
│   • 표준화된 구조     • 빠른 시장 출시      • 대화 연속성                │
│   • 관리형 인프라     • 확장 가능성         • 일관된 경험                │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 2. 배경 및 문제 정의

### 2.1 현재 상황

현재 AI 에이전트 개발 및 배포 과정에서 다음과 같은 문제점이 존재한다:

| 문제 영역 | 현재 상태 | 영향 |
|----------|----------|------|
| **인프라 관리** | 수동 서버 설정, 스케일링 | 개발자 시간 낭비, 운영 부담 |
| **세션 관리** | 자체 구현 필요 | 개발 복잡도 증가, 일관성 부족 |
| **메모리/컨텍스트** | 미지원 또는 자체 구현 | 개인화 부족, 반복적인 정보 요청 |
| **모니터링** | 분산된 도구, 수동 설정 | 장애 대응 지연, 가시성 부족 |
| **보안** | 개별 구현 | 보안 취약점 위험, 규정 준수 어려움 |

### 2.2 해결 방안

VertexAI Agent Engine을 채택하여 위 문제들을 해결한다:

```
┌─────────────────────────────────────────────────────────────────────────┐
│                      Solution Architecture                               │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   문제: 인프라 관리      ──►  해결: Agent Engine 관리형 런타임           │
│   문제: 세션 관리        ──►  해결: Agent Engine Sessions (GA)          │
│   문제: 메모리/컨텍스트  ──►  해결: Agent Engine Memory Bank (GA)       │
│   문제: 모니터링         ──►  해결: Cloud Trace/Logging 자동 통합       │
│   문제: 보안             ──►  해결: VPC-SC, CMEK, IAM, HIPAA 지원      │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 2.3 Agent Engine 선택 근거

| 평가 항목 | Agent Engine | Cloud Run (대안) | 결정 근거 |
|----------|--------------|------------------|----------|
| 인프라 관리 | 완전 관리형 | 컨테이너 관리 필요 | ✅ 운영 부담 최소화 |
| Session 관리 | 내장 (GA) | 직접 구현 | ✅ 개발 시간 단축 |
| Memory Bank | 내장 (GA) | 직접 구현 | ✅ 핵심 기능 제공 |
| Observability | 자동 통합 | 설정 필요 | ✅ 즉시 사용 가능 |
| 버전 관리 | 제한적 | Revision 기반 | △ 수용 가능 |
| 커스터마이징 | 제한적 | 완전 제어 | △ 수용 가능 |

**결론**: 핵심 기능(Session, Memory)의 내장 지원과 운영 부담 최소화를 우선하여 Agent Engine 선택

---

## 3. 범위 (Scope)

### 3.1 In Scope (포함)

#### Phase 1: Foundation (4주)
- [ ] Pydantic AI Agent 래퍼 클래스 개발
- [ ] Agent Engine 배포 파이프라인 구축
- [ ] 기본 Tool 라이브러리 구현
- [ ] 로컬 개발 환경 설정

#### Phase 2: Core Features (4주)
- [ ] Session 관리 통합
- [ ] Memory Bank 통합
- [ ] Cloud Trace/Logging 연동
- [ ] 기본 모니터링 대시보드

#### Phase 3: Production Readiness (4주)
- [ ] CI/CD 파이프라인 구축
- [ ] 버전 관리 시스템
- [ ] Agent 평가(Evaluation) 자동화
- [ ] 보안 설정 (VPC-SC, IAM)

#### Phase 4: Advanced Features (4주)
- [ ] 멀티 에이전트 지원 (A2A Protocol)
- [ ] 스트리밍 응답 지원
- [ ] 고급 모니터링 및 알림
- [ ] 비용 최적화

### 3.2 Out of Scope (제외)

| 항목 | 제외 사유 | 대안 |
|------|----------|------|
| 커스텀 컨테이너 이미지 | Agent Engine 제약 | Installation Scripts 활용 |
| Canary 배포 | Agent Engine 미지원 | 별도 인스턴스 기반 배포 |
| 실시간 A/B 테스트 | Phase 1 범위 초과 | 향후 Phase에서 검토 |
| 멀티 클라우드 | 복잡도 증가 | 단일 GCP 환경 집중 |
| 자체 LLM 호스팅 | 비용/복잡도 | VertexAI Gemini 활용 |

---

## 4. 시스템 아키텍처

### 4.1 High-Level Architecture

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              Overall Architecture                                │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│    ┌──────────────┐         ┌──────────────────────────────────────────────┐   │
│    │   Clients    │         │              Google Cloud Platform            │   │
│    │              │         │                                              │   │
│    │  ┌────────┐  │         │   ┌────────────────────────────────────┐    │   │
│    │  │Web App │  │         │   │        VertexAI Agent Engine        │    │   │
│    │  └───┬────┘  │         │   │                                    │    │   │
│    │      │       │         │   │  ┌────────────┐  ┌─────────────┐  │    │   │
│    │  ┌───┴────┐  │  HTTPS  │   │  │  Runtime   │  │  Sessions   │  │    │   │
│    │  │Mobile  │──┼────────►│   │  │ (managed)  │  │ (short-term)│  │    │   │
│    │  │  App   │  │         │   │  └─────┬──────┘  └──────┬──────┘  │    │   │
│    │  └───┬────┘  │         │   │        │                │         │    │   │
│    │      │       │         │   │        ▼                ▼         │    │   │
│    │  ┌───┴────┐  │         │   │  ┌─────────────────────────────┐  │    │   │
│    │  │  API   │  │         │   │  │     Pydantic AI Agent       │  │    │   │
│    │  │Client  │  │         │   │  │                             │  │    │   │
│    │  └────────┘  │         │   │  │  ┌───────┐ ┌───────┐       │  │    │   │
│    │              │         │   │  │  │ Tools │ │Prompts│       │  │    │   │
│    └──────────────┘         │   │  │  └───────┘ └───────┘       │  │    │   │
│                             │   │  └─────────────┬───────────────┘  │    │   │
│                             │   │                │                   │    │   │
│                             │   │  ┌─────────────▼─────────────┐    │    │   │
│                             │   │  │      Memory Bank          │    │    │   │
│                             │   │  │     (long-term)           │    │    │   │
│                             │   │  └───────────────────────────┘    │    │   │
│                             │   │                                    │    │   │
│                             │   └────────────────────────────────────┘    │   │
│                             │                     │                        │   │
│                             │                     ▼                        │   │
│                             │   ┌────────────────────────────────────┐    │   │
│                             │   │           VertexAI API             │    │   │
│                             │   │  ┌──────────────────────────────┐  │    │   │
│                             │   │  │    Gemini 2.5 Pro / Flash    │  │    │   │
│                             │   │  └──────────────────────────────┘  │    │   │
│                             │   └────────────────────────────────────┘    │   │
│                             │                                              │   │
│                             │   ┌────────────────────────────────────┐    │   │
│                             │   │          Observability             │    │   │
│                             │   │  Cloud Trace │ Logging │ Monitoring│    │   │
│                             │   └────────────────────────────────────┘    │   │
│                             │                                              │   │
│                             └──────────────────────────────────────────────┘   │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

### 4.2 Component Architecture

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                           Component Architecture                                 │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│   ┌─────────────────────────────────────────────────────────────────────────┐   │
│   │                        Agent Engine Instance                             │   │
│   │                                                                         │   │
│   │   ┌─────────────────────────────────────────────────────────────────┐   │   │
│   │   │                    Pydantic AI Agent Wrapper                     │   │   │
│   │   │                                                                 │   │   │
│   │   │   ┌─────────────┐  ┌─────────────┐  ┌─────────────────────┐   │   │   │
│   │   │   │   Agent     │  │   System    │  │    Model Settings   │   │   │   │
│   │   │   │   Config    │  │   Prompt    │  │  (temp, tokens...)  │   │   │   │
│   │   │   └─────────────┘  └─────────────┘  └─────────────────────┘   │   │   │
│   │   │                                                                 │   │   │
│   │   │   ┌─────────────────────────────────────────────────────────┐   │   │   │
│   │   │   │                     Tool Registry                        │   │   │   │
│   │   │   │                                                         │   │   │   │
│   │   │   │   ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐  │   │   │   │
│   │   │   │   │ Search   │ │Calculate │ │ DateTime │ │ Custom   │  │   │   │   │
│   │   │   │   │ Tool     │ │ Tool     │ │ Tool     │ │ Tools... │  │   │   │   │
│   │   │   │   └──────────┘ └──────────┘ └──────────┘ └──────────┘  │   │   │   │
│   │   │   │                                                         │   │   │   │
│   │   │   └─────────────────────────────────────────────────────────┘   │   │   │
│   │   │                                                                 │   │   │
│   │   │   ┌─────────────────────────────────────────────────────────┐   │   │   │
│   │   │   │                    API Methods                           │   │   │   │
│   │   │   │                                                         │   │   │   │
│   │   │   │   • query(message, user_id, session_id, memories)       │   │   │   │
│   │   │   │   • aquery(message, user_id, session_id)    [async]     │   │   │   │
│   │   │   │   • stream_query(message, user_id)          [stream]    │   │   │   │
│   │   │   │                                                         │   │   │   │
│   │   │   └─────────────────────────────────────────────────────────┘   │   │   │
│   │   │                                                                 │   │   │
│   │   └─────────────────────────────────────────────────────────────────┘   │   │
│   │                                                                         │   │
│   │   ┌───────────────────────┐       ┌───────────────────────┐            │   │
│   │   │      Sessions         │       │     Memory Bank       │            │   │
│   │   │                       │       │                       │            │   │
│   │   │  • Session lifecycle  │◄─────►│  • Memory generation  │            │   │
│   │   │  • Event history      │       │  • Memory retrieval   │            │   │
│   │   │  • Context window     │       │  • Memory revisions   │            │   │
│   │   │                       │       │                       │            │   │
│   │   └───────────────────────┘       └───────────────────────┘            │   │
│   │                                                                         │   │
│   └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

### 4.3 Data Flow Architecture

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              Data Flow Diagram                                   │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│   [User Request]                                                                │
│        │                                                                        │
│        ▼                                                                        │
│   ┌─────────────────────────────────────────────────────────────────────────┐   │
│   │ 1. REQUEST PROCESSING                                                    │   │
│   │                                                                         │   │
│   │    message: "What's my order status?"                                   │   │
│   │    user_id: "user_123"                                                  │   │
│   │    session_id: "sess_abc"                                               │   │
│   │                                                                         │   │
│   └─────────────────────────────────────────────────────────────────────────┘   │
│        │                                                                        │
│        ▼                                                                        │
│   ┌─────────────────────────────────────────────────────────────────────────┐   │
│   │ 2. CONTEXT RETRIEVAL                                                     │   │
│   │                                                                         │   │
│   │    ┌─────────────────────┐    ┌─────────────────────┐                  │   │
│   │    │  Session History    │    │   Memory Bank       │                  │   │
│   │    │                     │    │                     │                  │   │
│   │    │  [Recent messages   │    │  [Long-term facts   │                  │   │
│   │    │   in this session]  │    │   about this user]  │                  │   │
│   │    │                     │    │                     │                  │   │
│   │    │  "Hi, I'm John"     │    │  • Name: John       │                  │   │
│   │    │  "Check my order"   │    │  • Prefers email    │                  │   │
│   │    │                     │    │  • VIP customer     │                  │   │
│   │    └─────────────────────┘    └─────────────────────┘                  │   │
│   │                                                                         │   │
│   └─────────────────────────────────────────────────────────────────────────┘   │
│        │                                                                        │
│        ▼                                                                        │
│   ┌─────────────────────────────────────────────────────────────────────────┐   │
│   │ 3. AGENT EXECUTION                                                       │   │
│   │                                                                         │   │
│   │    ┌─────────────────────────────────────────────────────────────┐      │   │
│   │    │                   Pydantic AI Agent                         │      │   │
│   │    │                                                             │      │   │
│   │    │   Input:                                                    │      │   │
│   │    │   - User message                                            │      │   │
│   │    │   - Session context                                         │      │   │
│   │    │   - Retrieved memories                                      │      │   │
│   │    │   - System prompt                                           │      │   │
│   │    │                                                             │      │   │
│   │    │   Processing:                                               │      │   │
│   │    │   - Reasoning with Gemini                                   │      │   │
│   │    │   - Tool selection & execution                              │      │   │
│   │    │   - Response generation                                     │      │   │
│   │    │                                                             │      │   │
│   │    └─────────────────────────────────────────────────────────────┘      │   │
│   │                              │                                          │   │
│   │                              ▼                                          │   │
│   │    ┌─────────────────────────────────────────────────────────────┐      │   │
│   │    │                    Tool Execution                           │      │   │
│   │    │                                                             │      │   │
│   │    │   [order_lookup_tool]                                       │      │   │
│   │    │      └── Query order database                               │      │   │
│   │    │      └── Return: Order #12345, Shipped, ETA: Tomorrow       │      │   │
│   │    │                                                             │      │   │
│   │    └─────────────────────────────────────────────────────────────┘      │   │
│   │                                                                         │   │
│   └─────────────────────────────────────────────────────────────────────────┘   │
│        │                                                                        │
│        ▼                                                                        │
│   ┌─────────────────────────────────────────────────────────────────────────┐   │
│   │ 4. POST-PROCESSING                                                       │   │
│   │                                                                         │   │
│   │    ┌─────────────────────┐    ┌─────────────────────┐                  │   │
│   │    │  Update Session     │    │   Generate Memory   │                  │   │
│   │    │                     │    │   (if significant)  │                  │   │
│   │    │  Append events:     │    │                     │                  │   │
│   │    │  - User message     │    │  New fact:          │                  │   │
│   │    │  - Agent response   │    │  "User has order    │                  │   │
│   │    │  - Tool calls       │    │   #12345 in transit"│                  │   │
│   │    │                     │    │                     │                  │   │
│   │    └─────────────────────┘    └─────────────────────┘                  │   │
│   │                                                                         │   │
│   └─────────────────────────────────────────────────────────────────────────┘   │
│        │                                                                        │
│        ▼                                                                        │
│   [User Response]                                                               │
│                                                                                 │
│   "Hi John! Your order #12345 has been shipped and will arrive tomorrow.       │
│    I'll send a confirmation to your email as you prefer."                      │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

---

## 5. 기능 요구사항

### 5.1 Agent Core (핵심 에이전트)

#### 5.1.1 Agent Wrapper Class

| ID | 요구사항 | 우선순위 | 상세 |
|----|----------|----------|------|
| AC-001 | Agent Engine 규격 준수 | P0 | `__init__`, `set_up`, `query` 메서드 구현 |
| AC-002 | Pydantic AI 통합 | P0 | Pydantic AI Agent를 래핑하여 Agent Engine에서 실행 |
| AC-003 | VertexAI Gemini 연동 | P0 | GoogleProvider를 통한 Gemini 모델 사용 |
| AC-004 | 동기/비동기 지원 | P0 | `query` (sync), `aquery` (async) 메서드 제공 |
| AC-005 | 스트리밍 지원 | P1 | `stream_query` 메서드로 실시간 응답 스트리밍 |
| AC-006 | 에러 핸들링 | P0 | 예외 발생 시 graceful degradation |

#### 5.1.2 Tool System

| ID | 요구사항 | 우선순위 | 상세 |
|----|----------|----------|------|
| TS-001 | Tool 등록 메커니즘 | P0 | Pydantic AI @tool 데코레이터 기반 |
| TS-002 | 기본 Tool 라이브러리 | P1 | 검색, 계산, 날짜/시간 등 공통 Tool |
| TS-003 | 커스텀 Tool 확장 | P1 | 개발자가 쉽게 새 Tool 추가 가능 |
| TS-004 | Tool 실행 로깅 | P1 | 모든 Tool 호출 기록 및 추적 |
| TS-005 | Tool 타임아웃 | P1 | 개별 Tool 실행 시간 제한 |

#### 5.1.3 Prompt Management

| ID | 요구사항 | 우선순위 | 상세 |
|----|----------|----------|------|
| PM-001 | System Prompt 설정 | P0 | 환경 변수 또는 설정 파일로 관리 |
| PM-002 | Dynamic Prompt | P1 | 런타임에 컨텍스트 기반 프롬프트 조정 |
| PM-003 | Prompt 버전 관리 | P2 | 프롬프트 변경 이력 추적 |

### 5.2 Session Management (세션 관리)

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                           Session Lifecycle                                      │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│   [Create]        [Active]           [Idle]           [Expired]                │
│      │               │                  │                  │                    │
│      │  First        │   Messages       │   No activity    │   TTL             │
│      │  message      │   exchanged      │   for X hours    │   exceeded        │
│      │               │                  │                  │                    │
│      ▼               ▼                  ▼                  ▼                    │
│   ┌──────┐       ┌──────┐          ┌──────┐          ┌──────┐                  │
│   │ New  │──────►│Active│─────────►│ Idle │─────────►│Delete│                  │
│   │      │       │      │          │      │          │      │                  │
│   └──────┘       └──────┘          └──────┘          └──────┘                  │
│                      │                  │                                       │
│                      │   Resume         │                                       │
│                      │◄─────────────────┘                                       │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

| ID | 요구사항 | 우선순위 | 상세 |
|----|----------|----------|------|
| SM-001 | 세션 생성 | P0 | 사용자별 새 세션 자동 생성 |
| SM-002 | 세션 이벤트 기록 | P0 | 대화 내용 자동 저장 (AppendEvent) |
| SM-003 | 세션 이력 조회 | P0 | 이전 대화 내용 로드 (ListEvents) |
| SM-004 | 세션 TTL 관리 | P1 | 세션 만료 정책 설정 (기본 24시간) |
| SM-005 | 세션 삭제 | P1 | 명시적 세션 종료 지원 |
| SM-006 | 세션 메타데이터 | P2 | 세션별 추가 정보 저장 |

### 5.3 Memory Bank (장기 메모리)

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                           Memory Bank Architecture                               │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│   ┌─────────────────────────────────────────────────────────────────────────┐   │
│   │                         Memory Generation                                │   │
│   │                                                                         │   │
│   │   Session Events ──► Gemini Analysis ──► Fact Extraction ──► Storage   │   │
│   │                                                                         │   │
│   │   Example:                                                              │   │
│   │   "I prefer to be contacted by email, not phone"                        │   │
│   │                          │                                              │   │
│   │                          ▼                                              │   │
│   │   Memory: { user_id: "123", fact: "Prefers email contact" }            │   │
│   │                                                                         │   │
│   └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                 │
│   ┌─────────────────────────────────────────────────────────────────────────┐   │
│   │                         Memory Retrieval                                 │   │
│   │                                                                         │   │
│   │   Query ──► Similarity Search ──► Relevant Memories ──► Agent Context  │   │
│   │                                                                         │   │
│   │   Types:                                                                │   │
│   │   • Simple Retrieval: 모든 메모리 조회                                   │   │
│   │   • Similarity Search: 관련 메모리만 조회 (semantic search)             │   │
│   │                                                                         │   │
│   └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                 │
│   ┌─────────────────────────────────────────────────────────────────────────┐   │
│   │                         Memory Revisions                                 │   │
│   │                                                                         │   │
│   │   v1 ──► v2 ──► v3 (current)                                           │   │
│   │                    │                                                    │   │
│   │                    └──► Rollback to v2 if needed                       │   │
│   │                                                                         │   │
│   └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

| ID | 요구사항 | 우선순위 | 상세 |
|----|----------|----------|------|
| MB-001 | 메모리 생성 | P0 | 세션 대화에서 자동 fact 추출 |
| MB-002 | 메모리 조회 | P0 | 사용자별 관련 메모리 검색 |
| MB-003 | Similarity Search | P1 | 질문과 관련된 메모리만 선택적 조회 |
| MB-004 | 메모리 직접 생성 | P1 | Agent가 명시적으로 메모리 저장 |
| MB-005 | 메모리 Revision | P2 | 메모리 버전 관리 및 롤백 |
| MB-006 | 메모리 삭제 | P1 | 사용자 요청 시 메모리 삭제 (GDPR) |

### 5.4 Deployment & Management (배포 및 관리)

| ID | 요구사항 | 우선순위 | 상세 |
|----|----------|----------|------|
| DM-001 | SDK 기반 배포 | P0 | Python SDK를 통한 배포 |
| DM-002 | 소스 기반 배포 | P0 | CI/CD 파이프라인용 소스 파일 배포 |
| DM-003 | Agent 목록 조회 | P0 | 배포된 Agent 목록 및 상태 확인 |
| DM-004 | Agent 업데이트 | P0 | 설정 및 코드 업데이트 |
| DM-005 | Agent 삭제 | P0 | Agent 및 관련 리소스 삭제 |
| DM-006 | 버전 관리 | P1 | 배포 버전 이력 관리 |
| DM-007 | 롤백 | P1 | 이전 버전으로 복구 |
| DM-008 | 환경 분리 | P1 | Staging/Production 환경 분리 |

### 5.5 Observability (관측성)

| ID | 요구사항 | 우선순위 | 상세 |
|----|----------|----------|------|
| OB-001 | Cloud Trace 통합 | P0 | 요청 추적 및 지연 시간 분석 |
| OB-002 | Cloud Logging 통합 | P0 | 구조화된 로그 수집 |
| OB-003 | 메트릭 수집 | P1 | 요청 수, 에러율, 토큰 사용량 |
| OB-004 | 대시보드 | P1 | 주요 지표 시각화 |
| OB-005 | 알림 설정 | P2 | 임계치 기반 알림 |

---

## 6. 비기능 요구사항

### 6.1 성능 (Performance)

| 항목 | 요구사항 | 측정 방법 |
|------|----------|----------|
| 응답 지연 시간 (P50) | < 2초 | Cloud Trace 분석 |
| 응답 지연 시간 (P99) | < 10초 | Cloud Trace 분석 |
| 처리량 | > 100 QPS | 부하 테스트 |
| Cold Start | < 30초 | 최초 요청 시간 측정 |

### 6.2 가용성 (Availability)

| 항목 | 요구사항 | 상세 |
|------|----------|------|
| SLA | 99.9% | 월간 다운타임 < 43분 |
| 장애 복구 시간 (RTO) | < 5분 | 자동 복구 |
| 데이터 손실 (RPO) | 0 | 세션/메모리 손실 없음 |

### 6.3 확장성 (Scalability)

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                           Auto-Scaling Configuration                             │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│   Instances:                                                                    │
│                                                                                 │
│   Min: 1                                              Max: 100                  │
│    │                                                      │                     │
│    │  ┌──┐  ┌──┐  ┌──┐  ┌──┐  ┌──┐     ...          ┌──┐  │                     │
│    └──│  │──│  │──│  │──│  │──│  │─────────────────│  │──┘                     │
│       └──┘  └──┘  └──┘  └──┘  └──┘                  └──┘                        │
│                                                                                 │
│   Scaling Triggers:                                                             │
│   • CPU Utilization > 70%                                                       │
│   • Request Queue Depth > 10                                                    │
│   • Concurrent Requests > 80% of capacity                                       │
│                                                                                 │
│   Scale-to-Zero: Disabled (min_instances=1 for production)                     │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

| 항목 | 요구사항 |
|------|----------|
| 최소 인스턴스 | 1 (Production) / 0 (Staging) |
| 최대 인스턴스 | 100 |
| 동시 요청 | 인스턴스당 80 요청 |
| 자동 확장 | CPU 70% 기준 |

### 6.4 보안 (Security)

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                           Security Architecture                                  │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│   ┌─────────────────────────────────────────────────────────────────────────┐   │
│   │                          Network Security                                │   │
│   │                                                                         │   │
│   │   Internet ──► Cloud Armor ──► Load Balancer ──► VPC-SC ──► Agent     │   │
│   │                 (WAF/DDoS)      (SSL/TLS)        (Perimeter)            │   │
│   │                                                                         │   │
│   └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                 │
│   ┌─────────────────────────────────────────────────────────────────────────┐   │
│   │                          Identity & Access                               │   │
│   │                                                                         │   │
│   │   ┌─────────────┐    ┌─────────────┐    ┌─────────────────────────┐    │   │
│   │   │   IAM       │    │  Service    │    │    Agent Identity       │    │   │
│   │   │   Roles     │    │  Account    │    │    (Preview)            │    │   │
│   │   │             │    │             │    │                         │    │   │
│   │   │ • Viewer    │    │ • Agent SA  │    │ • Per-agent identity    │    │   │
│   │   │ • Editor    │    │ • Minimal   │    │ • Fine-grained access   │    │   │
│   │   │ • Admin     │    │   permissions│   │                         │    │   │
│   │   │             │    │             │    │                         │    │   │
│   │   └─────────────┘    └─────────────┘    └─────────────────────────┘    │   │
│   │                                                                         │   │
│   └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                 │
│   ┌─────────────────────────────────────────────────────────────────────────┐   │
│   │                          Data Protection                                 │   │
│   │                                                                         │   │
│   │   ┌─────────────┐    ┌─────────────┐    ┌─────────────────────────┐    │   │
│   │   │   CMEK      │    │  Data       │    │    Access               │    │   │
│   │   │   (encrypt) │    │  Residency  │    │    Transparency         │    │   │
│   │   │             │    │             │    │                         │    │   │
│   │   │ Customer-   │    │ Region-     │    │ Audit logs for          │    │   │
│   │   │ managed     │    │ specific    │    │ Google access           │    │   │
│   │   │ keys        │    │ storage     │    │                         │    │   │
│   │   │             │    │             │    │                         │    │   │
│   │   └─────────────┘    └─────────────┘    └─────────────────────────┘    │   │
│   │                                                                         │   │
│   └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

| 항목 | 요구사항 | 상태 |
|------|----------|------|
| VPC-SC | 서비스 경계 내 배포 | 지원 (GA) |
| CMEK | 고객 관리 암호화 키 | 지원 (GA) |
| IAM | 최소 권한 원칙 | 구현 필수 |
| 데이터 거주 | 지역 내 데이터 저장 | 지원 (GA) |
| HIPAA | 의료 데이터 규정 준수 | 지원 (GA) |
| 감사 로그 | Cloud Audit Logs | 자동 활성화 |

---

## 7. 기술 스택

### 7.1 Core Technologies

| 영역 | 기술 | 버전 | 용도 |
|------|------|------|------|
| **Runtime** | VertexAI Agent Engine | GA | 에이전트 호스팅 |
| **Framework** | Pydantic AI | >= 1.51.0 | 에이전트 프레임워크 |
| **LLM** | Gemini 2.5 Pro/Flash | Latest | 언어 모델 |
| **Language** | Python | 3.11+ | 개발 언어 |

### 7.2 GCP Services

| 서비스 | 용도 |
|--------|------|
| VertexAI Agent Engine Runtime | 에이전트 실행 환경 |
| VertexAI Agent Engine Sessions | 세션 관리 |
| VertexAI Agent Engine Memory Bank | 장기 메모리 |
| VertexAI API | Gemini 모델 호출 |
| Cloud Trace | 분산 추적 |
| Cloud Logging | 로그 수집 |
| Cloud Monitoring | 메트릭 및 알림 |
| Secret Manager | 시크릿 관리 |
| Cloud Build | CI/CD |
| Artifact Registry | 패키지 저장 |

### 7.3 Development Tools

| 도구 | 용도 |
|------|------|
| Poetry / pip | 의존성 관리 |
| pytest | 테스트 |
| ruff | 린팅 |
| mypy | 타입 체크 |
| structlog | 구조화된 로깅 |

---

## 8. API 설계

### 8.1 Agent API Methods

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              Agent API Specification                             │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│   Method: query (Synchronous)                                                   │
│   ─────────────────────────────                                                 │
│                                                                                 │
│   Request:                                                                      │
│   {                                                                             │
│     "message": string,          // Required: 사용자 메시지                       │
│     "user_id": string,          // Optional: 사용자 식별자 (default: anonymous) │
│     "session_id": string,       // Optional: 세션 ID (없으면 새로 생성)          │
│     "context": object,          // Optional: 추가 컨텍스트                       │
│     "memories": string[]        // Optional: Memory Bank에서 조회된 메모리       │
│   }                                                                             │
│                                                                                 │
│   Response:                                                                     │
│   {                                                                             │
│     "response": string,         // Agent 응답 텍스트                             │
│     "tool_calls": [             // 실행된 도구 목록                              │
│       {                                                                         │
│         "tool": string,                                                         │
│         "args": object                                                          │
│       }                                                                         │
│     ],                                                                          │
│     "usage": {                  // 토큰 사용량                                   │
│       "prompt_tokens": int,                                                     │
│       "completion_tokens": int,                                                 │
│       "total_tokens": int                                                       │
│     },                                                                          │
│     "metadata": {               // 메타데이터                                    │
│       "model": string,                                                          │
│       "user_id": string,                                                        │
│       "session_id": string,                                                     │
│       "timestamp": string                                                       │
│     }                                                                           │
│   }                                                                             │
│                                                                                 │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│   Method: stream_query (Async Streaming)                                        │
│   ────────────────────────────────────────                                      │
│                                                                                 │
│   Request: (same as query)                                                      │
│                                                                                 │
│   Response Stream:                                                              │
│   {                                                                             │
│     "chunk": string,            // 응답 청크                                     │
│     "done": boolean             // 스트림 종료 여부                              │
│   }                                                                             │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

### 8.2 REST API Endpoints (Agent Engine 제공)

| Endpoint | Method | 설명 |
|----------|--------|------|
| `/reasoningEngines` | GET | Agent 목록 조회 |
| `/reasoningEngines` | POST | Agent 생성 |
| `/reasoningEngines/{id}` | GET | Agent 상세 조회 |
| `/reasoningEngines/{id}` | PATCH | Agent 업데이트 |
| `/reasoningEngines/{id}` | DELETE | Agent 삭제 |
| `/reasoningEngines/{id}:query` | POST | Agent 쿼리 실행 |
| `/reasoningEngines/{id}/sessions` | POST | 세션 생성 |
| `/reasoningEngines/{id}/sessions/{sid}:appendEvent` | POST | 세션 이벤트 추가 |
| `/reasoningEngines/{id}/sessions/{sid}:listEvents` | GET | 세션 이벤트 조회 |
| `/reasoningEngines/{id}:retrieveMemories` | POST | 메모리 조회 |
| `/reasoningEngines/{id}/sessions/{sid}:generateMemories` | POST | 메모리 생성 |

---

## 9. 배포 전략

### 9.1 환경 구성

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                           Environment Strategy                                   │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│   ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐            │
│   │   Development   │    │     Staging     │    │   Production    │            │
│   │                 │    │                 │    │                 │            │
│   │  Local + Agent  │───►│  Agent Engine   │───►│  Agent Engine   │            │
│   │  Engine (test)  │    │  (staging)      │    │  (production)   │            │
│   │                 │    │                 │    │                 │            │
│   │  • 개발자 테스트 │    │  • 통합 테스트   │    │  • 실서비스      │            │
│   │  • 빠른 반복    │    │  • E2E 테스트   │    │  • 모니터링      │            │
│   │  • 디버깅       │    │  • 성능 테스트   │    │  • 알림          │            │
│   │                 │    │                 │    │                 │            │
│   │  min_instances: │    │  min_instances: │    │  min_instances: │            │
│   │  0              │    │  0              │    │  1+             │            │
│   │                 │    │                 │    │                 │            │
│   └─────────────────┘    └─────────────────┘    └─────────────────┘            │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

### 9.2 버전 관리 전략

Agent Engine은 Canary 배포를 직접 지원하지 않으므로, **별도 인스턴스 기반 버전 관리** 전략을 사용한다:

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                           Version Management Strategy                            │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│   Version History:                                                              │
│   ────────────────                                                              │
│                                                                                 │
│   v1.0.0 (agent-id-001) ─── Archived                                           │
│       │                                                                         │
│       ▼                                                                         │
│   v1.1.0 (agent-id-002) ─── Available (Rollback target)                        │
│       │                                                                         │
│       ▼                                                                         │
│   v1.2.0 (agent-id-003) ─── 🟢 PRODUCTION (Current)                            │
│       │                                                                         │
│       ▼                                                                         │
│   v1.3.0 (agent-id-004) ─── Staging (Testing)                                  │
│                                                                                 │
│                                                                                 │
│   Deployment Flow:                                                              │
│   ────────────────                                                              │
│                                                                                 │
│   1. 새 버전 개발 완료                                                          │
│       │                                                                         │
│       ▼                                                                         │
│   2. 새 Agent Engine 인스턴스로 Staging 배포                                    │
│       │                                                                         │
│       ▼                                                                         │
│   3. Staging에서 테스트 및 평가                                                  │
│       │                                                                         │
│       ▼                                                                         │
│   4. Production 승격 (클라이언트가 새 Agent ID 사용)                            │
│       │                                                                         │
│       ▼                                                                         │
│   5. 이전 버전 보관 (롤백 대비)                                                  │
│       │                                                                         │
│       ▼                                                                         │
│   6. 오래된 버전 정리 (최근 N개 유지)                                            │
│                                                                                 │
│                                                                                 │
│   Rollback Process:                                                             │
│   ─────────────────                                                             │
│                                                                                 │
│   1. 이전 버전 Agent ID 확인                                                    │
│       │                                                                         │
│       ▼                                                                         │
│   2. 클라이언트 설정 변경 (Agent ID 교체)                                       │
│       │                                                                         │
│       ▼                                                                         │
│   3. 트래픽 전환 완료                                                           │
│       │                                                                         │
│       ▼                                                                         │
│   4. 문제 버전 분석 및 수정                                                      │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

### 9.3 CI/CD Pipeline

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              CI/CD Pipeline                                      │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│   [Code Push]                                                                   │
│       │                                                                         │
│       ▼                                                                         │
│   ┌─────────────────────────────────────────────────────────────────────────┐   │
│   │ 1. CODE QUALITY                                                          │   │
│   │    • Lint (ruff)                                                        │   │
│   │    • Type check (mypy)                                                  │   │
│   │    • Security scan (bandit)                                             │   │
│   └─────────────────────────────────────────────────────────────────────────┘   │
│       │                                                                         │
│       ▼                                                                         │
│   ┌─────────────────────────────────────────────────────────────────────────┐   │
│   │ 2. TESTING                                                               │   │
│   │    • Unit tests                                                         │   │
│   │    • Integration tests                                                  │   │
│   │    • Coverage report                                                    │   │
│   └─────────────────────────────────────────────────────────────────────────┘   │
│       │                                                                         │
│       ▼                                                                         │
│   ┌─────────────────────────────────────────────────────────────────────────┐   │
│   │ 3. EVALUATION                                                            │   │
│   │    • Agent quality evaluation                                           │   │
│   │    • Response accuracy check                                            │   │
│   │    • Minimum score threshold (85%)                                      │   │
│   └─────────────────────────────────────────────────────────────────────────┘   │
│       │                                                                         │
│       ▼                                                                         │
│   ┌─────────────────────────────────────────────────────────────────────────┐   │
│   │ 4. STAGING DEPLOYMENT                                                    │   │
│   │    • Deploy to Agent Engine (staging)                                   │   │
│   │    • Smoke tests                                                        │   │
│   │    • E2E tests                                                          │   │
│   └─────────────────────────────────────────────────────────────────────────┘   │
│       │                                                                         │
│       ▼                                                                         │
│   ┌─────────────────────────────────────────────────────────────────────────┐   │
│   │ 5. APPROVAL GATE                                                         │   │
│   │    • Manual approval for production                                     │   │
│   │    • Or automatic promotion (if all checks pass)                        │   │
│   └─────────────────────────────────────────────────────────────────────────┘   │
│       │                                                                         │
│       ▼                                                                         │
│   ┌─────────────────────────────────────────────────────────────────────────┐   │
│   │ 6. PRODUCTION DEPLOYMENT                                                 │   │
│   │    • Deploy to Agent Engine (production)                                │   │
│   │    • Update version registry                                            │   │
│   │    • Notify team                                                        │   │
│   └─────────────────────────────────────────────────────────────────────────┘   │
│       │                                                                         │
│       ▼                                                                         │
│   ┌─────────────────────────────────────────────────────────────────────────┐   │
│   │ 7. POST-DEPLOYMENT                                                       │   │
│   │    • Monitor metrics                                                    │   │
│   │    • Alert on anomalies                                                 │   │
│   │    • Cleanup old versions                                               │   │
│   └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

---

## 10. 모니터링 및 운영

### 10.1 모니터링 지표

| 카테고리 | 지표 | 임계치 | 알림 |
|----------|------|--------|------|
| **Latency** | P50 응답 시간 | < 2s | Warning > 3s |
| **Latency** | P99 응답 시간 | < 10s | Critical > 15s |
| **Errors** | 에러율 | < 1% | Critical > 5% |
| **Traffic** | QPS | 모니터링 | - |
| **Resources** | CPU 사용률 | < 70% | Warning > 80% |
| **Resources** | 메모리 사용률 | < 70% | Warning > 80% |
| **LLM** | 토큰 사용량 | 모니터링 | Budget alert |
| **Sessions** | 활성 세션 수 | 모니터링 | - |
| **Memory** | 메모리 생성 수 | 모니터링 | - |

### 10.2 로깅 전략

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              Logging Strategy                                    │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│   Log Levels:                                                                   │
│   ───────────                                                                   │
│                                                                                 │
│   DEBUG   → 개발 환경 전용, 상세 디버깅 정보                                     │
│   INFO    → 일반 운영 정보 (요청 처리, 세션 생성 등)                             │
│   WARNING → 잠재적 문제 (재시도, 지연 등)                                        │
│   ERROR   → 에러 발생 (예외, 실패 등)                                           │
│   CRITICAL→ 심각한 장애 (서비스 불가 등)                                         │
│                                                                                 │
│   Structured Log Format:                                                        │
│   ──────────────────────                                                        │
│                                                                                 │
│   {                                                                             │
│     "timestamp": "2026-02-02T10:30:00Z",                                        │
│     "level": "INFO",                                                            │
│     "message": "Query completed",                                               │
│     "trace_id": "abc123",                                                       │
│     "span_id": "def456",                                                        │
│     "user_id": "user_123",                                                      │
│     "session_id": "sess_789",                                                   │
│     "agent_version": "1.2.0",                                                   │
│     "latency_ms": 1523,                                                         │
│     "tokens_used": 850,                                                         │
│     "tool_calls": ["search_knowledge"]                                          │
│   }                                                                             │
│                                                                                 │
│   Sensitive Data Handling:                                                      │
│   ────────────────────────                                                      │
│                                                                                 │
│   • 사용자 메시지 원문: 로깅하지 않음 (또는 마스킹)                               │
│   • PII (개인정보): 자동 마스킹                                                  │
│   • API 키/토큰: 절대 로깅하지 않음                                              │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

### 10.3 알림 정책

| 알림 레벨 | 조건 | 대응 |
|----------|------|------|
| **P1 (Critical)** | 서비스 다운, 에러율 > 10% | 즉시 대응 (24/7) |
| **P2 (High)** | 에러율 > 5%, 지연 > 15s | 업무 시간 내 1시간 이내 |
| **P3 (Medium)** | Warning 임계치 초과 | 업무 시간 내 4시간 이내 |
| **P4 (Low)** | 정보성 알림 | 다음 업무일 확인 |

---

## 11. 프로젝트 일정

### 11.1 Phase별 마일스톤

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              Project Timeline                                    │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│   Phase 1: Foundation (Week 1-4)                                                │
│   ══════════════════════════════                                                │
│                                                                                 │
│   W1  ────────────────────────────────────────────────                          │
│       │ • 개발 환경 설정                                                        │
│       │ • Pydantic AI Agent 기본 구조 개발                                      │
│       │ • Agent Engine 연동 테스트                                              │
│                                                                                 │
│   W2  ────────────────────────────────────────────────                          │
│       │ • Agent Wrapper 클래스 완성                                             │
│       │ • 기본 Tool 구현 (3개)                                                  │
│       │ • 로컬 테스트 환경 구축                                                  │
│                                                                                 │
│   W3  ────────────────────────────────────────────────                          │
│       │ • 배포 스크립트 개발 (SDK 기반)                                         │
│       │ • Agent Engine 배포 테스트                                              │
│       │ • 기본 에러 핸들링                                                       │
│                                                                                 │
│   W4  ────────────────────────────────────────────────                          │
│       │ • 소스 기반 배포 구현                                                    │
│       │ • 단위 테스트 작성                                                       │
│       │ • Phase 1 문서화                                                        │
│                                                                                 │
│   🎯 Milestone: Agent Engine 배포 및 기본 쿼리 동작                              │
│                                                                                 │
│   ───────────────────────────────────────────────────────────────────────────   │
│                                                                                 │
│   Phase 2: Core Features (Week 5-8)                                             │
│   ═════════════════════════════════                                             │
│                                                                                 │
│   W5  ────────────────────────────────────────────────                          │
│       │ • Session 관리 통합                                                     │
│       │ • 세션 생성/조회/삭제                                                    │
│       │ • 세션 이벤트 기록                                                       │
│                                                                                 │
│   W6  ────────────────────────────────────────────────                          │
│       │ • Memory Bank 통합                                                      │
│       │ • 메모리 생성/조회                                                       │
│       │ • 메모리 기반 개인화                                                     │
│                                                                                 │
│   W7  ────────────────────────────────────────────────                          │
│       │ • Cloud Trace 연동                                                      │
│       │ • Cloud Logging 구조화                                                  │
│       │ • 기본 메트릭 수집                                                       │
│                                                                                 │
│   W8  ────────────────────────────────────────────────                          │
│       │ • 모니터링 대시보드 구축                                                 │
│       │ • 통합 테스트 작성                                                       │
│       │ • Phase 2 문서화                                                        │
│                                                                                 │
│   🎯 Milestone: Session, Memory, Observability 완전 동작                        │
│                                                                                 │
│   ───────────────────────────────────────────────────────────────────────────   │
│                                                                                 │
│   Phase 3: Production Readiness (Week 9-12)                                     │
│   ═════════════════════════════════════════                                     │
│                                                                                 │
│   W9  ────────────────────────────────────────────────                          │
│       │ • CI/CD 파이프라인 구축 (Cloud Build)                                   │
│       │ • 자동화된 테스트 실행                                                   │
│       │ • 코드 품질 게이트                                                       │
│                                                                                 │
│   W10 ────────────────────────────────────────────────                          │
│       │ • 버전 관리 시스템 구현                                                  │
│       │ • 롤백 메커니즘                                                          │
│       │ • 환경 분리 (Staging/Prod)                                              │
│                                                                                 │
│   W11 ────────────────────────────────────────────────                          │
│       │ • Agent 평가 자동화 (Evaluation)                                        │
│       │ • 품질 임계치 설정                                                       │
│       │ • 성능 테스트                                                            │
│                                                                                 │
│   W12 ────────────────────────────────────────────────                          │
│       │ • 보안 설정 (VPC-SC, IAM)                                               │
│       │ • 알림 정책 구성                                                         │
│       │ • Production 배포                                                        │
│                                                                                 │
│   🎯 Milestone: Production 환경 운영 시작                                        │
│                                                                                 │
│   ───────────────────────────────────────────────────────────────────────────   │
│                                                                                 │
│   Phase 4: Advanced Features (Week 13-16)                                       │
│   ═══════════════════════════════════════                                       │
│                                                                                 │
│   W13 ────────────────────────────────────────────────                          │
│       │ • 스트리밍 응답 구현                                                     │
│       │ • Bidirectional streaming                                               │
│                                                                                 │
│   W14 ────────────────────────────────────────────────                          │
│       │ • 멀티 에이전트 설계 (A2A Protocol)                                     │
│       │ • Agent 간 통신 구현                                                    │
│                                                                                 │
│   W15 ────────────────────────────────────────────────                          │
│       │ • 고급 모니터링                                                          │
│       │ • 비용 최적화                                                            │
│                                                                                 │
│   W16 ────────────────────────────────────────────────                          │
│       │ • 문서화 완료                                                            │
│       │ • 팀 교육                                                                │
│       │ • 프로젝트 회고                                                          │
│                                                                                 │
│   🎯 Milestone: 전체 기능 완료 및 안정화                                         │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

### 11.2 리소스 요구사항

| Role | 인원 | Phase 1-2 | Phase 3-4 |
|------|------|-----------|-----------|
| Tech Lead | 1 | 50% | 30% |
| Backend Engineer | 2 | 100% | 100% |
| DevOps Engineer | 1 | 30% | 70% |
| QA Engineer | 1 | 30% | 50% |

---

## 12. 비용 추정

### 12.1 Agent Engine 비용

| 항목 | 단가 | 예상 사용량 | 월 비용 |
|------|------|------------|--------|
| **Runtime (vCPU)** | $0.000044/vCPU-초 | 4 vCPU × 2초 × 300,000 요청 | ~$106 |
| **Runtime (Memory)** | $0.0000049/GiB-초 | 8 GiB × 2초 × 300,000 요청 | ~$24 |
| **Sessions** | TBD (2026.01.28~) | 300,000 세션 | TBD |
| **Memory Bank** | TBD (2026.01.28~) | 100,000 memories | TBD |

### 12.2 VertexAI Gemini 비용

| 모델 | 입력 ($/1M tokens) | 출력 ($/1M tokens) | 예상 월 비용 |
|------|-------------------|-------------------|-------------|
| Gemini 2.5 Pro | $1.25 | $5.00 | ~$500 |
| Gemini 2.5 Flash | $0.075 | $0.30 | ~$50 |

### 12.3 총 예상 비용 (월간)

| 항목 | 비용 |
|------|------|
| Agent Engine Runtime | ~$150 |
| Gemini API | ~$300 |
| Cloud Logging/Monitoring | ~$50 |
| 기타 (Storage, Network) | ~$50 |
| **총계** | **~$550/월** |

*참고: 일 10,000 요청 기준, 실제 비용은 트래픽에 따라 변동*

---

## 13. 리스크 및 완화 방안

| 리스크 | 영향도 | 발생 가능성 | 완화 방안 |
|--------|--------|------------|----------|
| Agent Engine 서비스 장애 | High | Low | 모니터링 강화, 알림 설정 |
| Gemini API 지연/장애 | High | Medium | 타임아웃 설정, 재시도 로직 |
| 메모리 오염 (Memory Poisoning) | Medium | Medium | 입력 검증, Model Armor 적용 |
| 비용 초과 | Medium | Medium | 예산 알림, 사용량 모니터링 |
| Session/Memory 과금 시작 (2026.01) | Medium | High | 비용 모니터링, 최적화 계획 |
| 버전 관리 복잡도 | Medium | High | 자동화된 버전 관리 시스템 |

---

## 14. 성공 지표 (KPIs)

| 지표 | 목표 | 측정 방법 | 주기 |
|------|------|----------|------|
| 배포 성공률 | > 95% | CI/CD 파이프라인 | 주간 |
| 평균 응답 시간 (P50) | < 2초 | Cloud Trace | 실시간 |
| 에러율 | < 1% | Cloud Monitoring | 실시간 |
| 서비스 가용성 | > 99.9% | Uptime check | 월간 |
| 메모리 활용률 | > 80% 대화에서 메모리 사용 | 로그 분석 | 주간 |
| 개발자 만족도 | > 4.0/5.0 | 설문조사 | 분기 |

---

## 15. 부록

### 15.1 용어 정의

| 용어 | 정의 |
|------|------|
| Agent Engine | VertexAI의 관리형 AI Agent 런타임 서비스 |
| Pydantic AI | Pydantic 기반 AI Agent 프레임워크 |
| Session | 단기 대화 컨텍스트 (단일 대화) |
| Memory Bank | 장기 사용자 정보 저장소 (다중 세션) |
| Memory Revision | 메모리 버전 관리 기능 |
| VPC-SC | VPC Service Controls (보안 경계) |
| CMEK | Customer-Managed Encryption Keys |

### 15.2 참고 문서

- [VertexAI Agent Engine Documentation](https://docs.cloud.google.com/agent-builder/agent-engine)
- [Pydantic AI Documentation](https://ai.pydantic.dev/)
- [Agent Engine Sessions](https://docs.cloud.google.com/agent-builder/agent-engine/sessions)
- [Agent Engine Memory Bank](https://docs.cloud.google.com/agent-builder/agent-engine/memory-bank)
- [Agent Starter Pack](https://googlecloudplatform.github.io/agent-starter-pack/)

### 15.3 변경 이력

| 버전 | 날짜 | 작성자 | 변경 내용 |
|------|------|--------|----------|
| 1.0 | 2026-02-02 | Platform Team | 초안 작성 |
